<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script src="sankeytotals_113.js"></script>
    <script src="sankeypolicyareas_113_HR.js"></script>
    <script type="text/javascript">

      //$.get( "sankeysubjects_113_HR", function( data ) {
      //    alert( "Load was performed." );
      //  });
      google.charts.load('current', {'packages':['sankey']});
      var mydata = allbills;
      google.charts.setOnLoadCallback(drawChart);
      var subjectList = [];
      for (var subject in allsubjects) {
        if (allsubjects.hasOwnProperty(subject)) {
          subjectList.push(subject);
        // do stuff
        }
      }
      subjectList.sort();
      var auxArr = [];
      $.each(subjectList, function(i, subject)
      {
          auxArr[i] = "<option value='" + i + "'>" + subject + "</option>";
      });

      function addSubjects() {
            $('#subjectlisting').append(auxArr.join(''));
            $( "#subjectlisting" ).change(function() {
              var mySubject = [];
              newsubject = $( "#subjectlisting option:selected" ).text();
              $.each( allsubjects[newsubject], function( key, value ) {
                //[ "Judiciary Committee", "Reported to Floor", 104 ],
                var parts = key.split("|");
                newRow = [];
                newRow.push(parts[0]);
                newRow.push(parts[1]);
                newRow.push(value);
                //newRow = '["' + parts[0] + '", "' + parts[1] + '", ' + value + ']';
                mySubject.push(newRow);
              });
              mydata = mySubject;
              drawChart();
            });
          }

      function drawChart() {
        console.log(mydata);
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'From');
        data.addColumn('string', 'To');
        data.addColumn('number', 'Weight');
        data.addRows(mydata);

        // Sets chart options.
        var options = {
          width: 1000,
        };

        // Instantiates and draws our chart, passing in some options.
        var chart = new google.visualization.Sankey(document.getElementById('sankey_basic'));
        chart.draw(data, options);
        addSubjects();
      }


    </script>
  </head>
  <body>
    <select id="subjectlisting">
     <option value="all">All Subjects</option>
   </select>
    <br />
    <div id="sankey_basic" style="width: 1000px; height: 900px;"></div>
  </body>
</html>
